<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Star Catcher Ultimate Edition</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: radial-gradient(circle at top, #070736, #000);
      color: white;
      font-family: 'Segoe UI', sans-serif;
    }
    #hud {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 20px;
      font-weight: bold;
    }
    #gameOver {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      display: none;
      opacity: 0;
      transition: opacity 1s;
    }
    #gameOver h1 {
      font-size: 42px;
      margin-bottom: 10px;
    }
    #restartBtn {
      background: #00ff88;
      color: #000;
      padding: 10px 25px;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      cursor: pointer;
      transition: 0.3s;
    }
    #restartBtn:hover {
      background: #00ffaa;
      transform: scale(1.05);
    }
    canvas {
      display: block;
      margin: auto;
    }
  </style>
</head>
<body>
  <div id="hud">Score: 0 | Lives: 3 | Level: 1</div>
  <div id="gameOver">
    <h1>Game Over</h1>
    <p id="finalScore"></p>
    <button id="restartBtn">Restart</button>
  </div>
  <canvas id="gameCanvas" width="600" height="400"></canvas>
  <script >
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const hud = document.getElementById("hud");
const gameOverScreen = document.getElementById("gameOver");
const finalScoreEl = document.getElementById("finalScore");
const restartBtn = document.getElementById("restartBtn");

// --- Game State ---
let score, lives, level, stars, particles, gameSpeed, spawnRate, gameRunning;

// --- Basket ---
const basket = {
  x: canvas.width / 2 - 40,
  y: canvas.height - 40,
  width: 80,
  height: 20,
  speed: 6,
  movingLeft: false,
  movingRight: false,
};

// --- Star Types ---
const starTypes = [
  { color: "yellow", points: 1 },
  { color: "cyan", points: 5 },
  { color: "red", points: -3 },
];

// --- Sounds ---
const catchSound = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");
const missSound = new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
const bgMusic = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_78b8217330.mp3");
bgMusic.loop = true;
bgMusic.volume = 0.4;

// --- Initialize Game ---
function initGame() {
  score = 0;
  lives = 3;
  level = 1;
  stars = [];
  particles = [];
  gameSpeed = 2;
  spawnRate = 0.02;
  gameRunning = true;
  gameOverScreen.style.display = "none";
  gameOverScreen.style.opacity = 0;
  hud.innerText = `Score: ${score} | Lives: ${lives} | Level: ${level}`;
  bgMusic.currentTime = 0;
  bgMusic.play();
  gameLoop();
}

// --- Create Star ---
function createStar() {
  const type = starTypes[Math.floor(Math.random() * starTypes.length)];
  const x = Math.random() * (canvas.width - 20);
  stars.push({ x, y: 0, color: type.color, points: type.points });
}

// --- Create Particle Explosion ---
function createParticles(x, y, color) {
  for (let i = 0; i < 10; i++) {
    particles.push({
      x,
      y,
      radius: Math.random() * 3 + 1,
      color,
      speedX: (Math.random() - 0.5) * 3,
      speedY: (Math.random() - 0.5) * 3,
      life: 30,
    });
  }
}

// --- Update Particles ---
function updateParticles() {
  for (let i = particles.length - 1; i >= 0; i--) {
    const p = particles[i];
    p.x += p.speedX;
    p.y += p.speedY;
    p.life--;
    if (p.life <= 0) particles.splice(i, 1);
  }
}

// --- Draw Particles ---
function drawParticles() {
  particles.forEach((p) => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
    ctx.fillStyle = p.color;
    ctx.fill();
  });
}

// --- Draw Stars ---
function drawStars() {
  stars.forEach((star) => {
    ctx.beginPath();
    ctx.arc(star.x + 10, star.y + 10, 10, 0, Math.PI * 2);
    ctx.fillStyle = star.color;
    ctx.shadowBlur = 10;
    ctx.shadowColor = star.color;
    ctx.fill();
    ctx.shadowBlur = 0;
  });
}

// --- Draw Basket ---
function drawBasket() {
  ctx.fillStyle = "#00ff88";
  ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
}

// --- Move Basket ---
function moveBasket() {
  if (basket.movingLeft && basket.x > 0) basket.x -= basket.speed;
  if (basket.movingRight && basket.x + basket.width < canvas.width)
    basket.x += basket.speed;
}

// --- Update Stars ---
function updateStars() {
  for (let i = stars.length - 1; i >= 0; i--) {
    stars[i].y += gameSpeed;

    // Catch star
    if (
      stars[i].y + 20 >= basket.y &&
      stars[i].x + 20 > basket.x &&
      stars[i].x < basket.x + basket.width
    ) {
      if (stars[i].points > 0) catchSound.play();
      else missSound.play();

      score += stars[i].points;
      if (score < 0) score = 0;
      createParticles(stars[i].x, stars[i].y, stars[i].color);
      if (stars[i].points < 0) lives--;

      stars.splice(i, 1);
      updateHUD();
      checkGameStatus();
      continue;
    }

    // Missed good star
    if (stars[i].y > canvas.height) {
      if (stars[i].points > 0) {
        lives--;
        missSound.play();
        createParticles(stars[i].x, stars[i].y, "white");
        updateHUD();
        checkGameStatus();
      }
      stars.splice(i, 1);
    }
  }
}

// --- Draw Background Stars ---
function drawBackgroundStars() {
  for (let i = 0; i < 40; i++) {
    ctx.fillStyle = `rgba(255,255,255,${Math.random()})`;
    ctx.fillRect(Math.random() * canvas.width, Math.random() * canvas.height, 2, 2);
  }
}

// --- Update HUD ---
function updateHUD() {
  hud.innerText = `Score: ${score} | Lives: ${lives} | Level: ${level}`;
}

// --- Check Level / Game Over ---
function checkGameStatus() {
  if (lives <= 0) endGame();
  if (score >= level * 20) {
    level++;
    gameSpeed += 0.5;
    spawnRate += 0.005;
    updateHUD();
  }
}

// --- End Game ---
function endGame() {
  gameRunning = false;
  bgMusic.pause();
  gameOverScreen.style.display = "block";
  setTimeout(() => (gameOverScreen.style.opacity = 1), 50);
  finalScoreEl.innerText = `Your final score: ${score}`;
}

// --- Controls ---
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowLeft") basket.movingLeft = true;
  if (e.key === "ArrowRight") basket.movingRight = true;
});
document.addEventListener("keyup", (e) => {
  if (e.key === "ArrowLeft") basket.movingLeft = false;
  if (e.key === "ArrowRight") basket.movingRight = false;
});

// --- Restart Button ---
restartBtn.addEventListener("click", initGame);

// --- Game Loop ---
function gameLoop() {
  if (!gameRunning) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBackgroundStars();

  if (Math.random() < spawnRate) createStar();
  moveBasket();
  updateStars();
  updateParticles();
  drawParticles();
  drawStars();
  drawBasket();

  requestAnimationFrame(gameLoop);
}

// Start game
initGame();

</script>
</body>
</html>
